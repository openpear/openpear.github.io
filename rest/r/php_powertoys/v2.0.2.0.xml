<?xml version="1.0" encoding="UTF-8" ?>
<r xmlns="http://pear.php.net/dtd/rest.release2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xlink="http://www.w3.org/1999/xlink" xsi:schemaLocation="http://pear.php.net/dtd/rest.release2 http://pear.php.net/dtd/rest.release2.xsd">
    <p xlink:href="/rest/p/php_powertoys">PHP_PowerToys</p>
    <c>openpear.org</c>
    <v>0.2.0</v>
    <a>0.2.0</a>
    <mp>4.2.0</mp>
    <st>stable</st>
    <l>PHP License 3.01</l>
    <m>FreeBSE</m>
    <s>密かに暖めてきたネタですが
なんか、Openpear_Utilに先を越された感じに(^^;
ですが、こちらのコンセプトは
汎用ではなく、あったらいいなというような
PHPのかゆい部分に手が届くライブラリです。


因みに命名ですが
Microsoft社が開発した公式のWindowsカスタマイズツール
Microsoft PowerToys for Windows
に由来しています


各メソッドについての説明


*getInstance
これは、クラスファクトリーそのままです。
ファイル名とクラス名が一緒であれば
そのままインスタンスとして取得してくる事が可能です。

*getPearI
PEARライブラリ向けのクラスファクトリーです。
使い方としては、いつも皆様がpearコマンドを使って
インストールする風な感じでOKです(例:Net_POP3)

*getPear
同じくPEARライブラリ向けのクラスファクトリーです。
ですが、これは上記と違いファイル名を指定して
インスタンスを持ってくるメソッドです。

*arrayKeyReplace
連想配列のキー名を、順序を保ったまま
置き換えるためのメソッドです。
因みに、違うキーで同じデータを入れても
新たに配列が生成されてしまうだけです。
仕事で必要になったため、PHP関数リファレンスを
覗いてもこのようなメソッドがなかったため
作成いたしました。

*is_file_ex
Ethnaに影響を受けました。
通常のis_fileではInclude_pathを
見に行かないので、作成しました(コピペではありません)
因みにMail_Mailerクラスでも実装しています。

*save_var_dump
var_dumpした結果はprint_rと違い
通常はファイルとして保存する事が出来ません。
それを保存出来るように拡張したメソッドです。

*checkBom
UTF-8なデータに相性の悪いBOMがないかチェックします。

*removeBom
UTF-8からBOMを削除して返します。

*addBom by 0.2.0
通常ならBOM排除なのですが、これは逆に
BOMを付加します。
過去のエディタを使っている人向けですが
需要はないでしょう。

*iopen
GDでそのまま画像を開こうとすると
識別してからimagecreatefrom(jpeg|gif|png)
という形で選ばなければなりません。
これは非常に厄介な問題なので
指定された画像の形式を自動識別して
リソース情報を返すメソッドです
命名はfopenという関数があるので、それに習いました。
但し、このメソッドはやや不安定なところがあるので注意が必要です(mspaintのjpegはなんか癖がある事が判明？

0.2.0
BMPファイルに対応させました

*ImageCreateFromBMP by 0.2.0
BMPファイルを開きGDリソースとして返します。
出典
http://jp.php.net/manual/ja/function.imagecreate.php#53879

*imagebmp by 0.2.0
BMPファイルを保存します。
出典
http://php.benscom.com/manual/ja/ref.image.php

*print_r_ex
変数の中身を展開するprint_r関数ですが
ブラウザ上で見ると非常に見辛いです。
これは、改行コードで単にブラウザに沿ってないだけの
問題ですが、それをブラウザからでも確認しやすくします。

*objectClone
PHP5からは「&amp;」を用いた参照代入をしなくても
シャローコピーになるようになりました。
もしディープコピーがしたい場合にはcloneを用いる
必要がありますが、深い階層の場合はcloneでは
事足りない事があるそうです、このメソッドでは
その部分を補います。

*file_get_contents_ex
場合によっては、危険なメソッドになるかもしれませんが
php.iniの設定で「allow_url_fopen」が
offにされていても、外部のコンテンツを取りにいけます。
因みに「allow_url_fopen」はini_setで値を変更する事は出来ません。

*extensionExist by 0.2.0
PHP拡張ファイルの有無を確認します。
例えばGDがない状況でimagecreatefromjpeg
をするとエラーの原因になってしまいますので
これを挟むと幸せになるかもしれません。

*imlibResizer by 0.2.0
GD imagick以上に高速画像編集が可能だという
imlib2の拡張を使ったリサイズメソッドです。
但し、私の環境ではコンパイル出来なかったり
セグメントフォルトが起きたりして確認
出来なかったので、コード自体は
ドキュメントによる勘です。

*in_array_ex by 0.2.0
PHPには配列の中に該当文字があるか調べる
in_array関数がありますが、このメソッドは
それを正規表現に対応させたものです。

*iniParser by 0.2.0
Windowsでよく使われる設定ファイルである
iniファイルをパースして配列で返すメソッドです。

*hexFromFile by 0.2.5
ファイルの中身を16進数で返すメソッドです。

*binFromFile by 0.2.5
ファイルの中身を2進数で返すメソッドです。

*garbageCollection by 0.2.5
メモリの開放を行うメソッドです。
信憑性確認してませんがw

*compressMobileHtml by 0.2.5
HTMLを圧縮する(と言っても文字的に)メソッドです。
携帯電話向けの機能なので、このような
メソッド名となっています。
携帯向けHTMLを作成する際は保守目的でインデント
改行とかを気にしなくてはなりませんが
実行時には、携帯からソースを見るとか
それがないから、おかしくとかがありませんし
また、携帯ではdeflateが効かないので
トラフィックの向上にも繋がると思います。
使い方はsample.phpにも書いていますが
インスタンス生成の際に
$pt = new PHP_Powertoys('compress');
と記述して下さい。



以上0.2.5で改良、追加した機能の一覧を含めました。
使い方はサンプルコードをご覧下さい。</s>
    <d>密かに暖めてきたネタですが
なんか、Openpear_Utilに先を越された感じに(^^;
ですが、こちらのコンセプトは
汎用ではなく、あったらいいなというような
PHPのかゆい部分に手が届くライブラリです。


因みに命名ですが
Microsoft社が開発した公式のWindowsカスタマイズツール
Microsoft PowerToys for Windows
に由来しています


各メソッドについての説明


*getInstance
これは、クラスファクトリーそのままです。
ファイル名とクラス名が一緒であれば
そのままインスタンスとして取得してくる事が可能です。

*getPearI
PEARライブラリ向けのクラスファクトリーです。
使い方としては、いつも皆様がpearコマンドを使って
インストールする風な感じでOKです(例:Net_POP3)

*getPear
同じくPEARライブラリ向けのクラスファクトリーです。
ですが、これは上記と違いファイル名を指定して
インスタンスを持ってくるメソッドです。

*arrayKeyReplace
連想配列のキー名を、順序を保ったまま
置き換えるためのメソッドです。
因みに、違うキーで同じデータを入れても
新たに配列が生成されてしまうだけです。
仕事で必要になったため、PHP関数リファレンスを
覗いてもこのようなメソッドがなかったため
作成いたしました。

*is_file_ex
Ethnaに影響を受けました。
通常のis_fileではInclude_pathを
見に行かないので、作成しました(コピペではありません)
因みにMail_Mailerクラスでも実装しています。

*save_var_dump
var_dumpした結果はprint_rと違い
通常はファイルとして保存する事が出来ません。
それを保存出来るように拡張したメソッドです。

*checkBom
UTF-8なデータに相性の悪いBOMがないかチェックします。

*removeBom
UTF-8からBOMを削除して返します。

*addBom by 0.2.0
通常ならBOM排除なのですが、これは逆に
BOMを付加します。
過去のエディタを使っている人向けですが
需要はないでしょう。

*iopen
GDでそのまま画像を開こうとすると
識別してからimagecreatefrom(jpeg|gif|png)
という形で選ばなければなりません。
これは非常に厄介な問題なので
指定された画像の形式を自動識別して
リソース情報を返すメソッドです
命名はfopenという関数があるので、それに習いました。
但し、このメソッドはやや不安定なところがあるので注意が必要です(mspaintのjpegはなんか癖がある事が判明？

0.2.0
BMPファイルに対応させました

*ImageCreateFromBMP by 0.2.0
BMPファイルを開きGDリソースとして返します。
出典
http://jp.php.net/manual/ja/function.imagecreate.php#53879

*imagebmp by 0.2.0
BMPファイルを保存します。
出典
http://php.benscom.com/manual/ja/ref.image.php

*print_r_ex
変数の中身を展開するprint_r関数ですが
ブラウザ上で見ると非常に見辛いです。
これは、改行コードで単にブラウザに沿ってないだけの
問題ですが、それをブラウザからでも確認しやすくします。

*objectClone
PHP5からは「&amp;」を用いた参照代入をしなくても
シャローコピーになるようになりました。
もしディープコピーがしたい場合にはcloneを用いる
必要がありますが、深い階層の場合はcloneでは
事足りない事があるそうです、このメソッドでは
その部分を補います。

*file_get_contents_ex
場合によっては、危険なメソッドになるかもしれませんが
php.iniの設定で「allow_url_fopen」が
offにされていても、外部のコンテンツを取りにいけます。
因みに「allow_url_fopen」はini_setで値を変更する事は出来ません。

*extensionExist by 0.2.0
PHP拡張ファイルの有無を確認します。
例えばGDがない状況でimagecreatefromjpeg
をするとエラーの原因になってしまいますので
これを挟むと幸せになるかもしれません。

*imlibResizer by 0.2.0
GD imagick以上に高速画像編集が可能だという
imlib2の拡張を使ったリサイズメソッドです。
但し、私の環境ではコンパイル出来なかったり
セグメントフォルトが起きたりして確認
出来なかったので、コード自体は
ドキュメントによる勘です。

*in_array_ex by 0.2.0
PHPには配列の中に該当文字があるか調べる
in_array関数がありますが、このメソッドは
それを正規表現に対応させたものです。

*iniParser by 0.2.0
Windowsでよく使われる設定ファイルである
iniファイルをパースして配列で返すメソッドです。

*hexFromFile by 0.2.5
ファイルの中身を16進数で返すメソッドです。

*binFromFile by 0.2.5
ファイルの中身を2進数で返すメソッドです。

*garbageCollection by 0.2.5
メモリの開放を行うメソッドです。
信憑性確認してませんがw

*compressMobileHtml by 0.2.5
HTMLを圧縮する(と言っても文字的に)メソッドです。
携帯電話向けの機能なので、このような
メソッド名となっています。
携帯向けHTMLを作成する際は保守目的でインデント
改行とかを気にしなくてはなりませんが
実行時には、携帯からソースを見るとか
それがないから、おかしくとかがありませんし
また、携帯ではdeflateが効かないので
トラフィックの向上にも繋がると思います。
使い方はsample.phpにも書いていますが
インスタンス生成の際に
$pt = new PHP_Powertoys('compress');
と記述して下さい。



以上0.2.5で改良、追加した機能の一覧を含めました。
使い方はサンプルコードをご覧下さい。</d>
    <da>2009-08-20 14:36:09</da>
    <n>
------------------------------------------------------------------------
r1128 | FreeBSE | 2009-08-20 08:47:15 +0900 (木, 20  8月 2009) | 3 lines

メソッド名がおかしかった imbligResizer→imlibResizerへ
in_array_exの実装(in_arrayの正規表現対応版)
ini形式のファイルをパース出来る、iniParserを実装
------------------------------------------------------------------------
r1117 | FreeBSE | 2009-08-16 20:39:44 +0900 (日, 16  8月 2009) | 4 lines

逆にBOMを付加するメソッドを追加
エクステンションの存在チェックをするメソッドを追加
動的指定を静的指定に全て変更
コメントがおかしかったのを修正
------------------------------------------------------------------------
r1101 | FreeBSE | 2009-08-12 16:38:15 +0900 (水, 12  8月 2009) | 4 lines

BMP認識の部分の修正
拡張ファイルの存在をチェックするメソッドの追加
imlib2によるリサイズメソッドの追加(たぶん、使わないと思う・・・)
bmpによる画像保存メソッドの追加(PHPリファレンスより)
------------------------------------------------------------------------
r1100 | FreeBSE | 2009-08-11 23:10:56 +0900 (火, 11  8月 2009) | 2 lines

需要があるかわからないけれど、bmpも開けるようにしてみた
サンプルも追加(24ビットBMP大きくてごめんなさい・・・)
------------------------------------------------------------------------
r1079 | FreeBSE | 2009-08-06 20:19:20 +0900 (木, 06  8月 2009) | 4 lines

サンプルファイル出来た＼(^o^)／
サンプルで画像の絶対パスを誤魔化していたのを修正
saveVarDumpはvar_dumpの拡張なのでPHP基準に合わせsave_var_dumpに改称
GDがなかった時のエラーハンドリングを追加(Fatal回避阻止)
------------------------------------------------------------------------
r1066 | FreeBSE | 2009-08-05 20:26:30 +0900 (水, 05  8月 2009) | 3 lines

PHP4でも使えるように修正
Openpear上のディレクトリの場所修正
コメントちょっとだけ修正
------------------------------------------------------------------------
r1064 | FreeBSE | 2009-08-05 20:19:01 +0900 (水, 05  8月 2009) | 1 line

移動
------------------------------------------------------------------------
r1063 | FreeBSE | 2009-08-05 20:18:30 +0900 (水, 05  8月 2009) | 1 line

移動
------------------------------------------------------------------------
r1060 | openpear | 2009-08-04 18:49:48 +0900 (火, 04  8月 2009) | 1 line

[Create Base Directory] PHP_PowerToys
------------------------------------------------------------------------
 </n>
    <f>216097</f>
    <g>http://openpear.org/get/PHP_PowerToys-0.2.0</g>
    <x xlink:href="package.0.2.0.xml"/>
</r>